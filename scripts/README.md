# 엑셀 파일 가공 도구

프로젝트에 반영하기 전에 엑셀 파일을 가공하는 도구입니다.

## 기능

1. **기존 엑셀 파일 가공**: 새 필드(예산 내/외, 사업구분, 프로젝트명, 산정근거, 고정비/변동비)를 자동으로 추가
2. **템플릿 생성**: 새 필드가 포함된 엑셀 템플릿 생성

## 사용법

### 1. 기존 엑셀 파일 가공

```bash
node scripts/process-excel.js <입력파일> <출력파일>
```

예시:
```bash
node scripts/process-excel.js data.xlsx processed_data.xlsx
```

**기능:**
- 기존 데이터를 읽어서 새 필드를 자동으로 추가합니다
- 새 필드가 없으면 기본값으로 채웁니다:
  - 예산 내/외: "예산 내" (기본값)
  - 사업구분: "전체" (기본값)
  - 프로젝트명: 적요 값 사용
  - 산정근거/집행내역: 적요 값 사용
  - 고정비/변동비: "변동비" (기본값)

### 2. 템플릿 생성

```bash
node scripts/process-excel.js --template <출력파일>
```

예시:
```bash
node scripts/process-excel.js --template budget_template.xlsx
```

**기능:**
- 새 필드가 포함된 엑셀 템플릿을 생성합니다
- 예시 데이터 2개 행이 포함되어 있습니다

## 필드 설명

| 필드명 | 설명 | 필수 | 기본값 |
|--------|------|------|--------|
| 부서 | 부서명 | ✅ | - |
| 계정과목 | 계정과목 | ✅ | - |
| 적요 | 적요 | ✅ | - |
| 월 | 월 (1-12) | ✅ | - |
| 연도 | 연도 | ✅ | - |
| 예산 | 예산 금액 | ✅ | - |
| 실제 | 실제 집행 금액 | ✅ | - |
| 예산 내/외 | 예산 내 또는 예산 외 | ❌ | 예산 내 |
| 사업구분 | 키즈, 초등, 중등, 전체 | ❌ | 전체 |
| 프로젝트명 | 프로젝트명/세부항목 | ❌ | 적요 값 |
| 산정근거/집행내역 | 산정근거 또는 집행내역 | ❌ | 적요 값 |
| 고정비/변동비 | 고정비 또는 변동비 | ❌ | 변동비 |

## 유효한 값

- **사업구분**: 키즈, 초등, 중등, 전체
- **고정비/변동비**: 고정비, 변동비
- **예산 내/외**: 예산 내, 예산 외 (또는 예산내, 예산외)

## 주의사항

1. 입력 파일은 첫 번째 시트의 데이터를 읽습니다
2. 기존 필드명이 다르면 스크립트 내의 `FIELD_MAPPING`을 수정해야 합니다
3. 출력 파일이 이미 존재하면 덮어씁니다


