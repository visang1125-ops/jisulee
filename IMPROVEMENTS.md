# 시스템 개선점 도출

## 🔴 긴급 (Critical)

### 1. 데이터 영구 저장소 부재
**문제**: 현재 메모리 기반 저장소만 사용하여 서버 재시작 시 데이터 손실
- **위치**: `server/storage.ts` - `MemStorage` 클래스
- **영향**: 프로덕션 환경에서 데이터 손실 위험
- **개선안**: 
  - SQLite 또는 PostgreSQL 데이터베이스 도입
  - 또는 파일 기반 JSON 저장소 추가

### 2. 부서/계정과목 하드코딩
**문제**: 부서와 계정과목이 코드에 하드코딩되어 있어 엑셀 파일의 새 항목이 자동 반영 안 됨
- **위치**: `shared/constants.ts`, `client/src/lib/constants.ts`
- **영향**: 새 부서/계정과목 추가 시 코드 수정 필요
- **개선안**:
  - 엑셀 파일에서 동적으로 부서/계정과목 목록 추출
  - 또는 별도 설정 파일로 관리

### 3. 엑셀 파싱 에러 처리 부족
**문제**: 엑셀 파일 파싱 실패 시 상세한 에러 정보 부족
- **위치**: `server/storage.ts` - `loadBudgetDataFromExcel`
- **개선안**:
  - 각 행별 상세 에러 로깅
  - 실패한 행 번호와 이유를 사용자에게 제공

## 🟠 중요 (High Priority)

### 4. 성능 최적화 부족
**문제**: 
- Dashboard에서 전체 데이터를 두 번 로드 (`useBudgetData` 두 번 호출)
- 계산 함수들이 매 렌더링마다 실행
- **위치**: `client/src/pages/Dashboard.tsx`
- **개선안**:
  ```typescript
  // useMemo로 계산 결과 캐싱
  const stats = useMemo(() => 
    calculateStats(budgetData, settlementMonth, allBudgetData),
    [budgetData, settlementMonth, allBudgetData]
  );
  ```

### 5. 중복 코드
**문제**: 
- 부서/계정과목 목록이 여러 파일에 중복 정의
- 유효성 검사 로직 중복 (`ImportPreviewDialog`, `server/storage.ts`)
- **개선안**:
  - 공통 유틸리티 함수로 추출
  - 단일 소스에서 관리

### 6. 타입 안정성
**문제**: 
- `any` 타입 사용 (`server/storage.ts`의 `entry: any`)
- 타입 단언 과다 사용
- **개선안**:
  - 엄격한 타입 정의
  - Zod 스키마로 런타임 검증

### 7. 에러 메시지 일관성
**문제**: 에러 메시지가 한글/영문 혼재, 일관성 부족
- **개선안**: 
  - 에러 메시지 상수화
  - 다국어 지원 고려

## 🟡 개선 권장 (Medium Priority)

### 8. 사용자 경험 (UX)

#### 8.1 폼 검증 개선
- **위치**: `client/src/pages/SettlementEntryPage.tsx`
- **문제**: 제출 후에만 에러 표시
- **개선안**: 실시간 검증, 필드별 에러 메시지

#### 8.2 로딩 상태 개선
- **문제**: 일부 컴포넌트에서 로딩 상태 표시 부족
- **개선안**: Suspense 경계 추가, 스켈레톤 UI 일관성

#### 8.3 데이터 새로고침
- **문제**: 엑셀 파일 재로드 후 수동 새로고침 필요
- **개선안**: 자동 새로고침 또는 알림 표시

### 9. 접근성 (A11y)
**현재 상태**: 일부 aria-label은 있으나 불완전
- **개선안**:
  - 모든 인터랙티브 요소에 aria-label 추가
  - 키보드 네비게이션 개선
  - 스크린 리더 테스트

### 10. 코드 품질

#### 10.1 매직 넘버/문자열
- **문제**: 하드코딩된 값들 (`retry: 1`, `retryDelay: 1000` 등)
- **개선안**: 상수로 추출

#### 10.2 함수 크기
- **문제**: 일부 함수가 너무 김 (`loadBudgetDataFromExcel` 200+ 줄)
- **개선안**: 작은 함수로 분리

#### 10.3 주석 및 문서화
- **문제**: JSDoc 주석 부족
- **개선안**: 공개 API에 JSDoc 추가

### 11. 보안

#### 11.1 입력 검증 강화
- **문제**: 클라이언트 측 검증만으로는 부족
- **개선안**: 서버 측 검증 강화, SQL Injection 방지 (DB 도입 시)

#### 11.2 CORS 설정
- **개선안**: 프로덕션 환경에서 CORS 정책 명시

### 12. 테스트
**현재 상태**: 테스트 코드 없음
- **개선안**:
  - 단위 테스트 (계산 함수들)
  - 통합 테스트 (API 엔드포인트)
  - E2E 테스트 (주요 사용자 플로우)

## 🟢 향후 개선 (Low Priority)

### 13. 기능 추가

#### 13.1 데이터 편집/삭제
- **현재**: 추가만 가능
- **개선안**: 수정/삭제 기능 추가

#### 13.2 데이터 내보내기 개선
- **개선안**: 
  - 다양한 형식 지원 (PDF, Excel)
  - 커스텀 리포트 생성

#### 13.3 알림 시스템
- **개선안**: 
  - 예산 초과 알림
  - 집행률 임계값 알림

#### 13.4 사용자 권한 관리
- **개선안**: 
  - 역할 기반 접근 제어
  - 감사 로그

### 14. 모니터링 및 로깅
- **개선안**:
  - 구조화된 로깅 (Winston, Pino)
  - 에러 추적 (Sentry)
  - 성능 모니터링

### 15. 문서화
- **개선안**:
  - API 문서 (Swagger/OpenAPI)
  - 사용자 가이드
  - 개발자 가이드

## 📊 우선순위 매트릭스

| 우선순위 | 개선 항목 | 예상 작업량 | 비즈니스 영향 |
|---------|----------|------------|--------------|
| 🔴 긴급 | 데이터 영구 저장소 | 2-3일 | 높음 |
| 🔴 긴급 | 부서/계정과목 동적 로드 | 1일 | 높음 |
| 🟠 중요 | 성능 최적화 | 1일 | 중간 |
| 🟠 중요 | 중복 코드 제거 | 2일 | 중간 |
| 🟡 권장 | UX 개선 | 2-3일 | 중간 |
| 🟡 권장 | 접근성 개선 | 1-2일 | 낮음 |
| 🟢 향후 | 테스트 추가 | 3-5일 | 중간 |

## 🎯 즉시 적용 가능한 개선사항

1. **성능 최적화** (30분)
   - Dashboard의 useMemo 적용
   - 불필요한 재렌더링 방지

2. **에러 메시지 개선** (1시간)
   - 에러 메시지 상수화
   - 사용자 친화적 메시지

3. **코드 정리** (2시간)
   - 매직 넘버 상수화
   - 주석 추가

4. **타입 안정성** (3시간)
   - any 타입 제거
   - 엄격한 타입 정의

